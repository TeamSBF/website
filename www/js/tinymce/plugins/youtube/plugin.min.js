(function(tiny)
{
	tiny.PluginManager.add("youtube",
		function(editor, url)
		{
			function showDialog()
			{
				editor.windowManager.open({
					title: "Insert a YouTube Video",
					file: url + "/display.html",
					width: 800,
					height: 530,
					inline: 1,
					resizable: true
				},
                {
                    selectedItem: tinymce.activeEditor.selection.getNode()
                });
			}
		
			editor.addButton("youtube",{
				icon: true,
				image: url + "/img/youtube.gif",
				tooltip: "Add/Edit a YouTube Video",
				onclick: showDialog
             });
             editor.on('postRender', function(e){
                editor.on("NodeChange", function(e)
                {
                    if(e.element.nodeName === "IMG")
                    {
                        //var img = $(e.element);
                        //if(img.attr("src").indexOf("youtu") > 0)
                            //alert("youtuber");
                    }
                });
			});
		});
}(tinymce));